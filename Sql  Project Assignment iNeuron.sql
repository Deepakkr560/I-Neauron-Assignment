CREATE DATABASE iNEURON;

USE iNEURON;

CREATE  TABLE SHOPPING_HISTORY(
PRODUCT VARCHAR(100) NOT NULL,
QUANTITY INT,
UNIT_PRICE INT NOT NULL);


INSERT INTO SHOPPING_HISTORY(PRODUCT,QUANTITY,UNIT_PRICE)
VALUES('MILK',3,10),
       ('BREAD',5,8),
       ('BISCUIT',8,7),
       ('MILK',5,6),
       ('BREAD',4,3),
       ('BISCUIT',2,3);
       
       
 SELECT DISTINCT(PRODUCT),SUM(QUANTITY+UNIT_PRICE) FROM SHOPPING_HISTORY GROUP BY PRODUCT ORDER BY PRODUCT;
       


---- TASK 2


CREATE  TABLE PHONES(
    NAME VARCHAR(50) NOT NULL UNIQUE,
    PHONE_NUMBER INT NOT NULL UNIQUE
);


   INSERT INTO PHONES
    VALUES('GABBIE',15342),
    ('ALEX',32124),
    ('LENA',21321),
     ('JACK',54312),
     ('DANIEL',23413);
     

CREATE  TABLE CALLS(
    ID INT NOT NULL,
    CALLER INT NOT NULL,
    CALLEE INT NOT NULL,
    DURATION INT NOT NULL,
    UNIQUE(ID));
  
    INSERT INTO CALLS(ID,CALLER,CALLEE,DURATION)
     VALUES(12,32124,15342,7),
           (15,21321,23413,2),
           (17,54312,15342,3),
           (19,23413,54312,1),
           (20,15342,23413,3),
           (22,32124,54312,5);
 

WITH DURATION AS (
SELECT CALLER ,SUM(DURATION) AS DURATION FROM CALLS GROUP BY CALLER
UNION ALL
SELECT CALLEE, SUM(DURATION) AS DURATION FROM CALLS GROUP BY CALLEE)
SELECT NAME ,DURATION FROM PHONES P INNER JOIN DURATION D ON D.CALLER = P.PHONE_NUMBER
GROUP BY NAME,DURATION
HAVING SUM(DURATION)>= 10
ORDER BY NAME;




---- TASK 3


CREATE TABLE TRANSACTIONS(
    AMOUNT INT NOT NULL,
    DATE DATE NOT NULL);
    
    INSERT INTO TRANSACTIONS
        VALUES(1001,'2020-01-06'),
              (-10,'2020-01-14'),
              (-75,'2020-01-20'),
              (-5,'20-01-25'),
              (-4,'20-01-29'),
              (2000.,'2020-03-10'),
              (-75,'2020-03-12'),
              (-20,'2020-03-15'),
              (40,'2020-03-15'),
              (-50,'2020-03-17'),
              (200,'2020-10-10'),
              (-200,'2020-10-10');


-- AFTER MANY ATTENMPT I AM GETTING ERROR TO SOlVE TASK 3 PROBLEM STATEMENT IAM UNABLE TO SOLVE TASK 3...IF ITS
 -- POSSIBLE THEN PLEASE GUIDE ME TO SOLVE THIS PROBLEM